<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Practice · MyPkg.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://Gudongyangg.github.io/MyPkg.jl/Library/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MyPkg.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Practice</a><ul class="internal"><li><a class="tocitem" href="#Features"><span>Features</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li><li class="toplevel"><a class="tocitem" href="#home-2"><span>home</span></a></li><li class="toplevel"><a class="tocitem" href="#Algorithms"><span>Algorithms</span></a></li><li><a class="tocitem" href="#The-Rejection-Method"><span>The Rejection Method</span></a></li><li><a class="tocitem" href="#Direct-Method-for-systems-with-delays"><span>Direct Method for systems with delays</span></a></li><li><a class="tocitem" href="#Next-Reaction-Method-for-systems-with-delays"><span>Next Reaction Method for systems with delays</span></a></li><li><a class="tocitem" href="#References-2"><span>References</span></a></li><li class="toplevel"><a class="tocitem" href="#练习page"><span>练习page</span></a></li><li><a class="tocitem" href="#Formula"><span>Formula</span></a></li><li><a class="tocitem" href="#Cross-Reference"><span>Cross Reference</span></a></li><li><a class="tocitem" href="#URL"><span>URL</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Practice</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Practice</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Gudongyangg/MyPkg.jl/blob/master/docs/src/Library.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="home"><a class="docs-heading-anchor" href="#home">home</a><a id="home-1"></a><a class="docs-heading-anchor-permalink" href="#home" title="Permalink"></a></h1><p>&amp;nbsp；&amp;nbsp；Gillespie developed a stochastic simulation algorithm (SSA)[J. Phys. Chem.81, 2350(1977)] to simulate stochastic dynamics of chemically reacting systems.In this algorithm, it is assumed that all reactions occur instantly.Since Gillespie’s exact SSA was developed for chemical reaction systems without delay, it is apparent that Gillespie’s SSA cannot produce exact simulation results for chemical reaction systems with delays.</p><p>&amp;nbsp；&amp;nbsp； Neglecting delays in certain cases may still produce acceptable results, but in some delay-sensitive cases, such as delay-induced oscillators,neglecting delays in simulation will lead to erroneous conclusions.</p><p>&amp;nbsp；&amp;nbsp；To solve this problem an exact SSA for chemical reaction systems with delays，Delay SSA was proposed, based upon the same fundamental premise of stochastic kinetics used by Gillespie in the development of his SSA.</p><h2 id="Features"><a class="docs-heading-anchor" href="#Features">Features</a><a id="Features-1"></a><a class="docs-heading-anchor-permalink" href="#Features" title="Permalink"></a></h2><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Install with Pkg, just like any other registered Julia package:</p><pre><code class="nohighlight hljs">pkg&gt; add PkgTemplates  # Press &#39;]&#39; to enter the Pkg REPL mode.</code></pre><p>You can use it by</p><pre><code class="nohighlight hljs">using DelaySSAToolkit
....</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1]: Xiaodong Cai, &quot;Exact stochastic simulation of coupled chemical reactions with delays&quot;, The Journal of Chemical Physics 126, 124108(2007). <a href="https://doi/10.1063/1.2710253">https://aip.scitation.org/doi/10.1063/1.2710253</a>.</p><p>[2]: David F. Anderson, &quot;A modified Next Reaction Method for simulating chemical systems with time dependent propensities and delays&quot;, The Journal of Chemical Physics 128, 109903(2008). <a href="https://aip.scitation.org/doi/10.1063/1.2799998">https://doi/10.1063/1.2799998</a>.</p><h1 id="home-2"><a class="docs-heading-anchor" href="#home-2">home</a><a class="docs-heading-anchor-permalink" href="#home-2" title="Permalink"></a></h1><h1 id="Algorithms"><a class="docs-heading-anchor" href="#Algorithms">Algorithms</a><a id="Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithms" title="Permalink"></a></h1><h2 id="The-Rejection-Method"><a class="docs-heading-anchor" href="#The-Rejection-Method">The Rejection Method</a><a id="The-Rejection-Method-1"></a><a class="docs-heading-anchor-permalink" href="#The-Rejection-Method" title="Permalink"></a></h2><p>Consider a system consisting of <span>$N&gt;=1$</span> chemical species,<span>${X_1, . . . , X_N}$</span>, undergoing <span>$M&gt;= 1$</span> chemical reactions through reaction channels <span>${R_1,...,R_M}$</span>, each of which is equipped with a propensity function (or intensity function in the mathematics literature),<span>$a_k(X)$</span>. The dynamic state of this chemical system can be described by the state vector <span>$X(t) =[X_1(t),...,X_N(t)]T$</span>, where <span>$X_n[t],n = 1,...,N,$</span> is the number of <span>$X_n$</span> molecules at time <span>$t$</span>, and <span>$[·]^T$</span> denotes the transpose of the vector in the bracket. The following assumption, sometimes called the fundamental premise of chemical kinetics, is based upon physical principles and serves as the base assumption for simulation methods of chemically reacting systems: <span>$a_k(X(t)) \Delta t + \omicron (t) = the probability that reaction k                                       takes place in a small time interval$</span> where <span>$\omicron (\Delta t)/\Delta t \rightarrow 0 as \Delta t \rightarrow 0$</span>. Based upon the assumption, the time until the next reaction, <span>$\Delta$</span>, is exponentially distributed with parameter  <span>$a_0(X(t)) = \begin{matrix} \sum_{k=0}^M a_k(X(t)) \end{matrix}$</span>and the probability that the next reaction is thekth is <span>$a_k(X(t))/a_0(X(t))$</span>.</p><h3 id="Pseudo-code"><a class="docs-heading-anchor" href="#Pseudo-code">Pseudo code</a><a id="Pseudo-code-1"></a><a class="docs-heading-anchor-permalink" href="#Pseudo-code" title="Permalink"></a></h3><ol><li><p>Initialize. Set the initial number of molecules of each species and set <span>$t = 0$</span>.</p></li><li><p>Calculate the propensity function,<span>$a_k$</span>, for each reaction.</p></li><li><p>Set <span>$a_0 = \begin{matrix} \sum_{k=1}^M a_k \end{matrix}$</span>.</p></li><li><p>Generate an independent uniform(0,1) random number,<span>$r_1$</span>, and set <span>$\Delta = 1/a_0ln(1/r_1)$</span>.</p></li><li><p>If there is a delayed reaction set to finish in <span>$[t, t + \Delta)$</span></p><ul><li>(a) Discard <span>$\Delta$</span>.</li><li>(b) Updatetto be the time of the next delayed reaction,<span>$\mu$</span>.</li><li>(c) Updatexaccording to the stored reaction <span>$\mu$</span>.</li><li>(d) Return to step 2 or quit.</li></ul></li><li><p>Else</p><ul><li>(a) Generate an independent uniform<span>$(0,1)$</span> random number <span>$r_2$</span>.</li><li>(b) Find <span>$\mu\in[1,...., m]$</span> such that</li></ul></li></ol><h2 id="Direct-Method-for-systems-with-delays"><a class="docs-heading-anchor" href="#Direct-Method-for-systems-with-delays">Direct Method for systems with delays</a><a id="Direct-Method-for-systems-with-delays-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-Method-for-systems-with-delays" title="Permalink"></a></h2><h2 id="Next-Reaction-Method-for-systems-with-delays"><a class="docs-heading-anchor" href="#Next-Reaction-Method-for-systems-with-delays">Next Reaction Method for systems with delays</a><a id="Next-Reaction-Method-for-systems-with-delays-1"></a><a class="docs-heading-anchor-permalink" href="#Next-Reaction-Method-for-systems-with-delays" title="Permalink"></a></h2><ol><li>Initialize. Set the initial number of molecules of each species and set <span>$t = 0$</span>. For each <span>$k ≤ M$</span>, set <span>$Pk = 0$</span> and <span>$Tk = 0$</span>, and for each delayed reaction channel set <span>$s_k = [\infty]$</span>.</li><li>Calculate the propensity function, <span>$a_k$</span>, for each reaction.</li><li>Generate <span>$M$</span> independent, uniform<span>$(0,1)$</span> random numbers, <span>$r_k$</span>, and set <span>$P_k = ln(1/r_k)$</span>.</li><li>Set <span>$\Delta t_k = min_k{(P_k − T_k)/a_k}$</span>.</li><li>Set <span>$\Delta = min_k{\Delta t_k, s_k(1) − t}$</span>.</li><li>Set <span>$t = t + \Delta$</span>.</li><li>If we chose the completion of the delayed reaction <span>$\mu$</span>:</li></ol><p>• Update the system based upon the completion of the reaction <span>$\mu$</span>. • Delete the first row of <span>$S_\mu$</span>.</p><ol><li>Elseif reaction <span>$\mu$</span> initiated and <span>$\mu\in ND$</span></li></ol><p>• Update the system according to reaction <span>$\mu$</span>.</p><ol><li>Elseif reaction <span>$\mu$</span> initiated and <span>$\mu\in CD$</span></li></ol><p>• Update sµ by inserting <span>$t + \tau_\mu$</span> into <span>$s_\mu$</span> in the second to last position.</p><ol><li>Elseif reaction <span>$\mu$</span> initiated and <span>$\mu\in ICD$</span></li></ol><p>• Update the system based upon the initiation of reaction <span>$\mu$</span>. • Update <span>$s_\mu$</span> by inserting <span>$t + \tau_\mu$</span> into <span>$s_\mu$</span> in the second to last position.</p><ol><li>For each k, set <span>$min_k{T_k} = min_k{T_k} + a_k\Delta$</span>.</li><li>If reaction <span>$\mu$</span> initiated, let <span>$r$</span> be uniform<span>$(0,1)$</span> and set <span>$P_µ = P_µ + ln(1/r)$</span>.</li><li>Recalculate the propensity functions, <span>$a_k$</span>.</li><li>Return to step 4 or quit.</li></ol><h2 id="References-2"><a class="docs-heading-anchor" href="#References-2">References</a><a class="docs-heading-anchor-permalink" href="#References-2" title="Permalink"></a></h2><p>[1]: Xiaodong Cai, &quot;Exact stochastic simulation of coupled chemical reactions with delays&quot;, The Journal of Chemical Physics 126, 124108(2007). <a href="https://aip.scitation.org/doi/10.1063/1.2710253">https://aip.scitation.org/doi/10.1063/1.2710253</a>. [2]: David F. Anderson, &quot;A modified Next Reaction Method for simulating chemical systems with time dependent propensities and delays&quot;, The Journal of Chemical Physics 128, 109903(2008). <a href="https://aip.scitation.org/doi/10.1063/1.2710253">https://aip.scitation.org/doi/10.1063/1.2710253</a>.</p><h1 id="练习page"><a class="docs-heading-anchor" href="#练习page">练习page</a><a id="练习page-1"></a><a class="docs-heading-anchor-permalink" href="#练习page" title="Permalink"></a></h1><p>这一页的content</p><ul><li><a href="#home">home</a></li><li class="no-marker"><ul><li><a href="#Features">Features</a></li><li><a href="#Installation">Installation</a></li><li><a href="#References">References</a></li></ul></li><li><a href="#home-2">home</a></li><li><a href="#Algorithms">Algorithms</a></li><li class="no-marker"><ul><li><a href="#The-Rejection-Method">The Rejection Method</a></li><li><a href="#Direct-Method-for-systems-with-delays">Direct Method for systems with delays</a></li><li><a href="#Next-Reaction-Method-for-systems-with-delays">Next Reaction Method for systems with delays</a></li><li><a href="#References-2">References</a></li></ul></li><li><a href="#练习page">练习page</a></li><li class="no-marker"><ul><li><a href="#Formula">Formula</a></li><li><a href="#Cross-Reference">Cross Reference</a></li><li><a href="#URL">URL</a></li></ul></li></ul><h2 id="Formula"><a class="docs-heading-anchor" href="#Formula">Formula</a><a id="Formula-1"></a><a class="docs-heading-anchor-permalink" href="#Formula" title="Permalink"></a></h2><p>一个点括起来表示程序，两个点括起来表示LaTeX公式，三个点括起来表示引用指定的宏来制作文档。</p><p>在MyPkg/docs/src/里的.md文件中，LaTeX的转义<code>\sqrt[n]{1 + x + x^2 + \ldots}</code>这里要写1条<code>\</code></p><p>而MyPkg/src/里的.jl文件中使用三个双引号括起来的形式，称为docstring，则需要两条<code>\\</code>，来表示LaTeX的转义<code>\\sqrt[n]{1 + x + x^2 + \\ldots}</code></p><p>Here&#39;s a example maths:<span>$\sqrt[n]{1 + x + x^2 + \ldots}$</span>.</p><h2 id="Cross-Reference"><a class="docs-heading-anchor" href="#Cross-Reference">Cross Reference</a><a id="Cross-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Cross-Reference" title="Permalink"></a></h2><ul><li>link to <a href="../#MyPkg">MyPkg</a></li><li>link to <a href="../#MyPkg.Simpson-Tuple{Any, Any, Any}"><code>Simpson(f, a, b)</code></a></li><li>link to <a href="../#function">function</a></li></ul><h2 id="URL"><a class="docs-heading-anchor" href="#URL">URL</a><a id="URL-1"></a><a class="docs-heading-anchor-permalink" href="#URL" title="Permalink"></a></h2><p>外部链接</p><p>More detail in <a href="https://juliadocs.github.io/Documenter.jl/stable/">Document.jl</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 26 November 2021 06:08">Friday 26 November 2021</span>. Using Julia version 1.6.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
